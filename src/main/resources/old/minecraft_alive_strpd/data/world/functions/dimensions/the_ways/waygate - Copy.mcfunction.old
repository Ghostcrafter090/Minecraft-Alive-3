# Define
scoreboard objectives add waygatetimea dummy
scoreboard objectives add waygatetimeb dummy
scoreboard objectives add regate dummy
scoreboard objectives add regatetime dummy

# Main
execute as @e[name=waygate] at @s positioned ~-1 ~-18 ~2 if entity @e[type=item_frame,limit=1,sort=nearest,nbt={Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:3b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}] run scoreboard players add @s waygatetimea 1
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s run fill ~ ~-19 ~1 ~ ~-17 ~-1 gray_stained_glass_pane replace air
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s run fill ~ ~-20 ~1 ~ ~-20 ~-1 glowstone replace
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s positioned ~ ~-19 ~1 as @e[distance=0..1,type=!item_frame] at @e[name=waygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in the_ways:the_ways run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s positioned ~ ~-19 ~ as @e[distance=0..1,type=!item_frame] at @e[name=waygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in the_ways:the_ways run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s positioned ~ ~-19 ~-1 as @e[distance=0..1,type=!item_frame] at @e[name=waygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in the_ways:the_ways run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s positioned ~ ~-18 ~1 as @e[distance=0..1,type=!item_frame] at @e[name=waygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in the_ways:the_ways run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s positioned ~ ~-18 ~ as @e[distance=0..1,type=!item_frame] at @e[name=waygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in the_ways:the_ways run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s positioned ~ ~-18 ~-1 as @e[distance=0..1,type=!item_frame] at @e[name=waygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in the_ways:the_ways run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s positioned ~ ~-17 ~1 as @e[distance=0..1,type=!item_frame] at @e[name=waygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in the_ways:the_ways run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waygate,scores={waygatetimea=1..1000}] at @s positioned ~ ~-17 ~ as @e[distance=0..1,type=!item_frame] at @e[name=waygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in the_ways:the_ways run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waygate,scores={waygatetimea=1..1}] at @s run playsound minecraft:item.trident.return master @a ~ ~ ~ 9 0.1
execute as @e[name=waygate,scores={waygatetimea=1..}] at @s positioned ~ ~-19 ~ if entity @e[name=dmain,scores={regu=10..}] run playsound minecraft:block.portal.trigger master @a ~ ~ ~ 0.1 0.1
execute as @e[name=waygate,scores={waygatetimea=1..}] at @s run particle minecraft:enchant ~ ~-19 ~ 0 2 1 0.1 300 force
execute as @e[name=waygate,scores={waygatetimea=1..}] at @s run particle minecraft:portal ~ ~-19 ~ 0 2 1 0.1 30 force
execute as @e[name=waygate,scores={waygatetimea=1000..}] at @s run fill ~ ~-19 ~1 ~ ~-17 ~-1 air replace gray_stained_glass_pane
execute as @e[name=waygate,scores={waygatetimea=1000..}] at @s run fill ~ ~-20 ~1 ~ ~-20 ~-1 cobblestone replace
execute as @e[name=waygate,scores={waygatetimea=1000..}] at @s positioned ~-1 ~-18 ~2 as @e[distance=0..5] run data merge entity @s {Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:0b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}
execute as @e[name=waygate,scores={waygatetimea=1000..}] at @s positioned ~-1 ~-18 ~2 as @e[distance=0..5] run playsound minecraft:block.portal.trigger master @a ~ ~ ~ 9 2
execute as @e[name=waygate,scores={waygatetimea=1000..}] run scoreboard players set @s waygatetimea -20
execute as @e[name=waygate,scores={waygatetimea=1..}] at @s positioned ~-1 ~-18 ~2 unless entity @e[type=item_frame,limit=1,distance=0..5,sort=nearest,nbt={Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:3b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}] run playsound minecraft:block.portal.trigger master @a ~ ~ ~ 9 2
execute as @e[name=waygate,scores={waygatetimea=1..}] at @s positioned ~-1 ~-18 ~2 unless entity @e[type=item_frame,limit=1,distance=0..5,sort=nearest,nbt={Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:3b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}] run scoreboard players set @s waygatetimea 1000
execute as @e[name=waygate,scores={waygatetimea=1..}] at @s at @s positioned ~-1 ~-18 ~2 unless entity @e[type=item_frame,limit=1,distance=0..5,sort=nearest,nbt={Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:3b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}] at @s in the_ways:the_ways as @e[name=waywaygate,distance=0..20] run scoreboard players set @s waygatetimeb 999

execute as @e[name=waywaygate] at @s positioned ~-1 ~-18 ~2 if entity @e[type=item_frame,limit=1,sort=nearest,nbt={Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:3b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}] run scoreboard players add @s waygatetimeb 1
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s run fill ~ ~-19 ~1 ~ ~-17 ~-1 gray_stained_glass_pane replace air
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s run fill ~ ~-20 ~1 ~ ~-20 ~-1 glowstone replace
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s positioned ~ ~-19 ~1 as @e[distance=0..1,type=!item_frame] at @e[name=waywaygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in minecraft:overworld run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s positioned ~ ~-19 ~ as @e[distance=0..1,type=!item_frame] at @e[name=waywaygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in minecraft:overworld run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s positioned ~ ~-19 ~-1 as @e[distance=0..1,type=!item_frame] at @e[name=waywaygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in minecraft:overworld run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s positioned ~ ~-18 ~1 as @e[distance=0..1,type=!item_frame] at @e[name=waywaygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in minecraft:overworld run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s positioned ~ ~-18 ~ as @e[distance=0..1,type=!item_frame] at @e[name=waywaygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in minecraft:overworld run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s positioned ~ ~-18 ~-1 as @e[distance=0..1,type=!item_frame] at @e[name=waywaygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in minecraft:overworld run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s positioned ~ ~-17 ~1 as @e[distance=0..1,type=!item_frame] at @e[name=waywaygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in minecraft:overworld run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waywaygate,scores={waygatetimeb=1..1000}] at @s positioned ~ ~-17 ~ as @e[distance=0..1,type=!item_frame] at @e[name=waywaygate,distance=0..30] positioned ~ ~-19 ~ rotated as @s in minecraft:overworld run tp @s ~2 ~ ~ ~ ~
execute as @e[name=waywaygate,scores={waygatetimeb=1..1}] at @s run playsound minecraft:item.trident.return master @a ~ ~ ~ 9 0.1
execute as @e[name=waywaygate,scores={waygatetimeb=1..}] at @s positioned ~ ~-19 ~ if entity @e[name=dmain,scores={regu=10..}] run playsound minecraft:block.portal.trigger master @a ~ ~ ~ 0.1 0.1
execute as @e[name=waywaygate,scores={waygatetimeb=1..}] at @s run particle minecraft:enchant ~ ~-19 ~ 0 2 1 0.1 300 force
execute as @e[name=waywaygate,scores={waygatetimeb=1..}] at @s run particle minecraft:portal ~ ~-19 ~ 0 2 1 0.1 30 force
execute as @e[name=waywaygate,scores={waygatetimeb=1000..}] at @s run fill ~ ~-19 ~1 ~ ~-17 ~-1 air replace gray_stained_glass_pane
execute as @e[name=waywaygate,scores={waygatetimeb=1000..}] at @s run fill ~ ~-20 ~1 ~ ~-20 ~-1 cobblestone replace
execute as @e[name=waywaygate,scores={waygatetimeb=1000..}] at @s positioned ~-1 ~-18 ~2 as @e[distance=0..5,type=item_frame] run data merge entity @s {Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:0b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}
execute as @e[name=waywaygate,scores={waygatetimeb=1000..}] at @s positioned ~-1 ~-18 ~2 as @e[distance=0..5] run playsound minecraft:block.portal.trigger master @a ~ ~ ~ 9 2
execute as @e[name=waywaygate,scores={waygatetimeb=1000..}] run scoreboard players set @s waygatetimeb -20
execute as @e[name=waywaygate,scores={waygatetimeb=1..}] at @s positioned ~-1 ~-18 ~2 unless entity @e[type=item_frame,limit=1,distance=0..5,sort=nearest,nbt={Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:3b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}] run playsound minecraft:block.portal.trigger master @a ~ ~ ~ 9 2
execute as @e[name=waywaygate,scores={waygatetimeb=1..}] at @s positioned ~-1 ~-18 ~2 unless entity @e[type=item_frame,limit=1,distance=0..5,sort=nearest,nbt={Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:3b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}] run scoreboard players set @s waygatetimeb 1000
execute as @e[name=waywaygate,scores={waygatetimeb=1..}] at @s at @s positioned ~-1 ~-18 ~2 unless entity @e[type=item_frame,limit=1,distance=0..5,sort=nearest,nbt={Paper.SpawnReason:"DEFAULT",Bukkit.updateLevel:2,OnGround:0b,ItemDropChance:1.0f,ItemRotation:3b,Invulnerable:1b,Fixed:0b,Rotation:[90.0f,0.0f],Facing:4b,CustomName:'{"text":"waygate_leaf_loc"}',Item:{id:"minecraft:kelp",tag:{display:{Name:'{"text":"Avendesora Leaf","color":"dark_green","bold":true,"italic":true}',Lore:['{"text":"Use to unlock a waygate."}']}},Count:1b},Invisible:1b,Air:0s,FallDistance:0.0f,NoGravity:1b,Motion:[0.0d,0.0d,0.0d],Fire:0s,PortalCooldown:0}] at @s in minecraft:overworld as @e[name=waygate,distance=0..20] run scoreboard players set @s waygatetimea 999

execute as @e[name=waygate] at @s if block ~ ~-19 ~ nether_bricks if block ~ ~-18 ~ nether_bricks if block ~ ~-18 ~1 nether_bricks if block ~ ~-18 ~-1 nether_bricks if block ~ ~-17 ~ minecraft:player_head{SkullOwner:{Properties:{textures:[{Value:"eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvOTc2MWEzODMxNTkyZWU0YTA4ZmYwOWQ3NTdlZDgyZWM5YjBmZDhhZGI3ZWY4MmRhMmI2ODZjM2M5YzY2ZWEifX19"}]}}} if block ~ ~-19 ~1 torch if block ~ ~-19 ~-1 torch positioned ~-1 ~-18 ~1 if entity @e[type=item_frame] run scoreboard players set @s regate 1
execute if entity @e[name=waygate,scores={regate=1..1}] run function world:dimensions/the_ways/wayspell
execute as @e[name=waywaygate] at @s if block ~ ~-19 ~ nether_bricks if block ~ ~-18 ~ nether_bricks if block ~ ~-18 ~1 nether_bricks if block ~ ~-18 ~-1 nether_bricks if block ~ ~-17 ~ minecraft:player_head{SkullOwner:{Properties:{textures:[{Value:"eyJ0ZXh0dXJlcyI6eyJTS0lOIjp7InVybCI6Imh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvOTc2MWEzODMxNTkyZWU0YTA4ZmYwOWQ3NTdlZDgyZWM5YjBmZDhhZGI3ZWY4MmRhMmI2ODZjM2M5YzY2ZWEifX19"}]}}} if block ~ ~-19 ~1 torch if block ~ ~-19 ~-1 torch positioned ~-1 ~-18 ~1 if entity @e[type=item_frame] run scoreboard players set @s regate 1
